"use strict";(self.modernJsonp=self.modernJsonp||[]).push([[47442],{792862:(e,n,a)=>{a.r(n),a.d(n,{default:()=>I});var t=a(667294),o=a(545007),l=a(883119),i=a(985459),r=a(547504),s=a(95460),d=a(909512),c=a(233846),u=a(298568);function p({constraint:e}){let n=(0,u.E)(),a=n?.getId();return(0,t.useEffect)(()=>{n&&n.markConstraintComplete(e)},[a,e]),null}var _=a(349057),m=a(181710),v=a(943369),h=a(677316),b=a(755090),w=a(604342),f=a(356204),y=a(739951),g=a(506536),k=a(757653),P=a(785893);let S=(0,k.Z)(()=>a.e(43473).then(a.bind(a,16736)),void 0,e=>16736,"PinSaveButtonCommon"),x=(0,t.lazy)(async()=>({default:(await Promise.all([a.e(69965),a.e(22538)]).then(a.bind(a,797043))).QuickSaveButtonWithExperienceAnchor})),I=({boardCount:e=0,clientTrackingParams:n,fromEggsBoard:a,onBoardSelectionFlyoutChange:k,onClickCallback:I,pin:T,showEnabledSaveBehavior:C,showRepinOnInitialRender:E,variant:Z,viewParameter:A,viewType:B,saveToBoardFromPostDownloadUpsell:j,setSaveToBoardFromPostDownloadUpsell:D})=>{let q=(0,u.E)(),{experience:F}=(0,d.Ow)(1000310),{experience:M}=(0,d.Ow)(12),Q=(0,h.Z)(),U=(0,o.I0)(),R=(0,c.ZP)(),K=(0,t.useRef)(!1),{pins:N,clear:O}=(0,f.Z)(),J=(0,v.M0)().getItem(r.M8)||"",W=J?J===T.id:!!N&&N.length>0&&N[N.length-1].id===T.id;(0,b.Z)(()=>{K.current||2!==N.length&&(1!==N.length||W)||(K.current=!0,(2===N.length&&!J&&W?[N[0]]:N).forEach(({id:e,nodeId:n})=>{(0,i.Z)({description:"",entityId:e,link:"",promotedIsRemovable:void 0,title:""},R).then(a=>{let{id:t,url:o,name:l}=a;U((0,y.d)({boardId:t,url:o,title:l||"",pinId:e||"",nodeId:n}))})}),W||O())});let z=()=>{(0,v.M0)().removeItem(r.M8),O(),Q({action:"trigger",item:"unauth-save-button-quicksave"}),U((0,g.Z)(!0)),U((0,y.d)({boardId:"",url:"",title:"Profile",pinId:T.id,nodeId:T?.node_id})),U((0,y.X)(T))},H=()=>{(0,_.Nx)("button"),q&&q.markConstraintComplete("button")};if(T?.pinner?.blocked_by_me||T?.promoted_is_removable)return(0,_.Nx)("button"),(0,P.jsx)(p,{constraint:"button"});if(F&&502450===F.experience_id)return(0,P.jsx)(s.Z,{name:"SafeSuspense_SaveAffordance_QuickSaveButton",children:(0,P.jsx)(m.Z,{children:(0,P.jsx)(x,{autoQuicksaveCallback:z,clientTrackingParams:n,experience:F,onClickCallback:I,onMount:H,pinKey:{type:"deprecated",data:T},saveToBoardFromPostDownloadUpsell:j,setSaveToBoardFromPostDownloadUpsell:D,shouldAutoQuicksave:W,showEnabledSaveBehavior:C,viewParameter:A})})});let V=!T.content_sensitivity?.is_sensitive_content&&void 0!==e,X=[501041],$=M&&501041===M.experience_id&&M.display_data.has_tooltip?e=>(0,P.jsx)(d.Qp,{anchor:e,experienceIds:X,idealDirection:"down",placementId:12,positionRelativeToAnchor:!0,showCaret:!0}):e=>(0,P.jsx)(d.N,{anchors:{3010:e},idealDirection:"down",onAnchorTouch:"complete",placementId:12,scrollToDismiss:!0});return V?(0,P.jsx)(l.xu,{children:(0,P.jsx)(s.Z,{name:"SafeSuspense_SaveAffordance_PinBetterSave",children:(0,P.jsx)(w.default,{autoQuicksaveCallback:z,clientTrackingParams:n,fromEggsBoard:a,onClickCallback:I,onMount:H,onToggleFlyout:k,pinKey:{type:"deprecated",data:T},renderPinSaveTooltip:$,saveToBoardFromPostDownloadUpsell:j,setSaveToBoardFromPostDownloadUpsell:D,shouldAutoQuicksave:W,variant:Z,viewParameter:A,viewType:B})})}):(0,P.jsx)(s.Z,{name:"SafeSuspense_SaveAffordance_PinSaveButton",children:(0,P.jsx)(m.Z,{children:(0,P.jsx)(S,{clientTrackingParams:n,isCloseupPin:!0,onClickCallback:I,onMount:H,pinKey:{type:"deprecated",data:T},renderPinSaveTooltip:$,saveToBoardFromPostDownloadUpsell:j,setSaveToBoardFromPostDownloadUpsell:D,showRepinOnInitialRender:E})})})}},356204:(e,n,a)=>{a.d(n,{$:()=>s,Z:()=>u});var t=a(547504),o=a(838380),l=a(967312),i=a(943369),r=a(756493);let s=2,d=e=>e?.pins??[],c=e=>e.length?{pins:e}:null,u=()=>{let e=(0,i.M0)(),n=d(e.accessAllowed?e.getItem(t.s1):r.ZP.getItem(o.w3)),a=n=>e.accessAllowed?e.setItem(t.s1,c(n)):r.ZP.setItem(o.w3,c(n)),u=s,{checkExperiment:p}=(0,l.F)(),_=()=>{let e=p("mweb_block_unauth_save").group;if(e.startsWith("enabled")){let[,n]=e.split("_");u=Number(n)}let a=p("mweb_q2_mau_push_pc").anyEnabled,t=p("mweb_q2_mau_push_pc_advanced").anyEnabled,o=p("mweb_q2_mau_push_pc_advanced_row").anyEnabled,l=p("mweb_q2_mau_push_pc_emergency").anyEnabled,i=p("mweb_q2_mau_push_pc_emergency_row").anyEnabled,r=p("mweb_q2_mau_push_pc_eu").anyEnabled,s=p("mweb_q2_mau_push_pc_eu_safe").anyEnabled;return(a||t||o||l||i||r||s)&&(u=0),n.length<u};return{pins:n,save:e=>{_()&&a(n.filter(({id:n})=>n!==e.id).concat([e]))},unsave:e=>a(n.filter(({id:n})=>n!==e)),isSaved:e=>n.some(({id:n})=>n===e),clear:()=>a([]),canSaveMore:_}}},506536:(e,n,a)=>{a.d(n,{Z:()=>t});function t(e){return{type:"UPDATE_HAS_QUICKSAVE_BOARD",payload:{createdQuicksaveBoard:e}}}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/SaveAffordance-770c91648f39259a.mjs.map